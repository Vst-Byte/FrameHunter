<Page x:Class="FrameHunterFPS.GameOptimizer"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Game Optimizer" FontFamily="Segoe UI Variable Display">

    <Page.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>

        <Color x:Key="NeonCyan">#00F2FF</Color>
        <Color x:Key="NeonPurple">#A033FF</Color>
        <SolidColorBrush x:Key="NeonBrush" Color="{StaticResource NeonCyan}"/>
        <SolidColorBrush x:Key="PanelBrush" Color="#0E1015"/>
        <SolidColorBrush x:Key="ScrollThumb" Color="#333842"/>
        <SolidColorBrush x:Key="ScrollThumbHover" Color="#4C5263"/>

        <LinearGradientBrush x:Key="FHGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="{StaticResource NeonCyan}" Offset="0"/>
            <GradientStop Color="{StaticResource NeonPurple}" Offset="1"/>
        </LinearGradientBrush>

        <Style x:Key="ScrollThumbStyle" TargetType="{x:Type Thumb}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Border x:Name="border" CornerRadius="3" Background="{TemplateBinding Background}"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="NeonScrollBar" TargetType="{x:Type ScrollBar}">
            <Setter Property="Stylus.IsFlicksEnabled" Value="false"/>
            <Setter Property="Foreground" Value="{StaticResource ScrollThumb}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Width" Value="6"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollBar}">
                        <Grid x:Name="GridRoot" Width="6" Background="{TemplateBinding Background}">
                            <Track x:Name="PART_Track" IsDirectionReversed="true" Focusable="false">
                                <Track.Thumb>
                                    <Thumb x:Name="Thumb" Background="{TemplateBinding Foreground}" Style="{DynamicResource ScrollThumbStyle}"/>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="Thumb" Property="Background" Value="{StaticResource ScrollThumbHover}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ProSwitch" TargetType="CheckBox">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#AAFFFFFF"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="0,10"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid Background="Transparent">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="{TemplateBinding Content}" Foreground="White" FontSize="13" FontWeight="SemiBold"/>
                                <TextBlock Text="{TemplateBinding ToolTip}" Foreground="#55FFFFFF" FontSize="11" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Border x:Name="Track" Grid.Column="1" Width="40" Height="20" CornerRadius="10" Background="#1A1D26" BorderBrush="#333" BorderThickness="1">
                                <Ellipse x:Name="Dot" Width="14" Height="14" Fill="#55FFFFFF" HorizontalAlignment="Left" Margin="3,0,0,0">
                                    <Ellipse.RenderTransform>
                                        <TranslateTransform X="0"/>
                                    </Ellipse.RenderTransform>
                                </Ellipse>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="Track" Property="Background" Value="{StaticResource FHGradient}"/>
                                <Setter TargetName="Track" Property="BorderBrush" Value="Transparent"/>
                                <Setter TargetName="Dot" Property="Fill" Value="White"/>
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="Dot" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" To="20" Duration="0:0:0.2" DecelerationRatio="0.8"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="Dot" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" To="0" Duration="0:0:0.2" DecelerationRatio="0.8"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="GameListItem" TargetType="ListBoxItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Margin" Value="0,8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <Grid>
                            <Border x:Name="Card" Background="#05FFFFFF" CornerRadius="10" 
                                    BorderThickness="1" BorderBrush="Transparent" Padding="12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <Border Width="70" Height="100" CornerRadius="6" ClipToBounds="True" Background="#111">
                                        <Image Source="{Binding ImageUrl}" Stretch="UniformToFill" RenderOptions.BitmapScalingMode="HighQuality"/>
                                        <Border.Effect>
                                            <DropShadowEffect BlurRadius="10" ShadowDepth="3" Opacity="0.4"/>
                                        </Border.Effect>
                                    </Border>

                                    <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="16,0,0,0">
                                        <TextBlock x:Name="TxtName" Text="{Binding Name}" Foreground="#BBFFFFFF" FontSize="15" FontWeight="Bold" TextTrimming="CharacterEllipsis"/>
                                        <Border HorizontalAlignment="Left" Background="#10FFFFFF" CornerRadius="4" Padding="6,2" Margin="0,6,0,0">
                                            <TextBlock x:Name="TxtStatus" Text="Optimize" Foreground="#88FFFFFF" FontSize="10" FontWeight="SemiBold"/>
                                        </Border>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <Border x:Name="Indicator" HorizontalAlignment="Left" Width="4" Height="60" CornerRadius="2" 
                                    Background="{StaticResource FHGradient}" Visibility="Collapsed" Margin="0,0,0,0">
                                <Border.Effect>
                                    <DropShadowEffect Color="#00F2FF" BlurRadius="12" ShadowDepth="0" Opacity="0.8"/>
                                </Border.Effect>
                            </Border>
                        </Grid>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Card" Property="Background" Value="#0DFFFFFF"/>
                                <Setter TargetName="TxtName" Property="Foreground" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Card" Property="Background" Value="#1A1D26"/>
                                <Setter TargetName="Card" Property="BorderBrush" Value="#33FFFFFF"/>
                                <Setter TargetName="Indicator" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="TxtName" Property="Foreground" Value="White"/>
                                <Setter TargetName="TxtStatus" Property="Text" Value="SELECTED"/>
                                <Setter TargetName="TxtStatus" Property="Foreground" Value="{StaticResource NeonBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Page.Resources>

    <Grid Background="#05070A">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="340"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Border Background="#080A0F" BorderBrush="#151820" BorderThickness="0,0,1,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <StackPanel Margin="30,40,30,20">
                    <TextBlock Text="LIBRARY" Foreground="{StaticResource NeonBrush}" FontSize="12" FontWeight="Bold" Opacity="0.8"/>
                    <TextBlock Text="INSTALLED GAMES" Foreground="White" FontSize="20" FontWeight="Black" Margin="0,5,0,0"/>
                </StackPanel>

                <ListBox x:Name="GamesList" Grid.Row="1" Background="Transparent" BorderThickness="0" 
                         ItemContainerStyle="{StaticResource GameListItem}" Padding="20,0"
                         ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                    <ListBox.Resources>
                        <Style TargetType="{x:Type ScrollBar}" BasedOn="{StaticResource NeonScrollBar}"/>
                    </ListBox.Resources>
                </ListBox>
            </Grid>
        </Border>

        <Grid Grid.Column="1" DataContext="{Binding ElementName=GamesList, Path=SelectedItem}">

            <TextBlock Text="Select a game to optimize" Foreground="#33FFFFFF" FontSize="18" FontWeight="Bold"
                       HorizontalAlignment="Center" VerticalAlignment="Center"
                       Visibility="{Binding Converter={StaticResource BoolToVis}, ConverterParameter=Invert}"/>

            <Grid Visibility="{Binding Converter={StaticResource BoolToVis}}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="200"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Grid Grid.Row="0" ClipToBounds="True">
                    <Image Source="{Binding ImageUrl}" Stretch="UniformToFill" Opacity="0.4" VerticalAlignment="Top" RenderOptions.BitmapScalingMode="HighQuality">
                        <Image.Effect>
                            <BlurEffect Radius="50"/>
                        </Image.Effect>
                    </Image>

                    <Rectangle>
                        <Rectangle.Fill>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                <GradientStop Color="#CC05070A" Offset="0"/>
                                <GradientStop Color="#05070A" Offset="1"/>
                            </LinearGradientBrush>
                        </Rectangle.Fill>
                    </Rectangle>

                    <Grid Margin="40,0,40,20" VerticalAlignment="Bottom">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Border Width="100" Height="140" CornerRadius="8" BorderBrush="#33FFFFFF" BorderThickness="1">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="20" ShadowDepth="5" Opacity="0.5"/>
                            </Border.Effect>
                            <Border CornerRadius="8" ClipToBounds="True">
                                <Image Source="{Binding ImageUrl}" Stretch="UniformToFill" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </Border>
                        </Border>

                        <StackPanel Grid.Column="1" VerticalAlignment="Bottom" Margin="25,0,0,5">
                            <Border Background="#2000F2FF" HorizontalAlignment="Left" CornerRadius="4" Padding="8,2" Margin="0,0,0,8" BorderBrush="{StaticResource NeonBrush}" BorderThickness="1">
                                <TextBlock Text="READY" Foreground="{StaticResource NeonBrush}" FontSize="10" FontWeight="Bold"/>
                            </Border>
                            <TextBlock Text="{Binding Name}" Foreground="White" FontSize="32" FontWeight="Black" TextWrapping="Wrap">
                                <TextBlock.Effect>
                                    <DropShadowEffect BlurRadius="10" Opacity="0.5"/>
                                </TextBlock.Effect>
                            </TextBlock>
                            <TextBlock Text="{Binding Source}" Foreground="#88FFFFFF" FontSize="12" Margin="0,4,0,0" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Grid>
                </Grid>

                <ScrollViewer Grid.Row="1" Margin="40,10,40,40">
                    <ScrollViewer.Resources>
                        <Style TargetType="{x:Type ScrollBar}" BasedOn="{StaticResource NeonScrollBar}"/>
                    </ScrollViewer.Resources>

                    <StackPanel>
                        <ToggleButton x:Name="BtnOptimize" Height="50" Cursor="Hand" Margin="0,0,0,30"
                                      IsChecked="{Binding IsExpanded, Mode=TwoWay}"
                                      Click="BtnOptimizeGame_Click" Tag="{Binding}">
                            <ToggleButton.Template>
                                <ControlTemplate TargetType="ToggleButton">
                                    <Grid>
                                        <Border x:Name="b" Background="#1A1D26" CornerRadius="8" BorderBrush="#33FFFFFF" BorderThickness="1"/>
                                        <Border x:Name="a" Background="{StaticResource FHGradient}" CornerRadius="8" Opacity="0">
                                            <Border.Effect>
                                                <DropShadowEffect Color="#00F2FF" BlurRadius="20" Opacity="0.3"/>
                                            </Border.Effect>
                                        </Border>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                            <TextBlock x:Name="icon" Text="⚡" Foreground="White" FontSize="16" Margin="0,0,10,0"/>
                                            <TextBlock x:Name="txt" Text="ENABLE OPTIMIZATION" Foreground="White" FontSize="13" FontWeight="Bold"/>
                                        </StackPanel>
                                    </Grid>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsChecked" Value="True">
                                            <Setter TargetName="a" Property="Opacity" Value="1"/>
                                            <Setter TargetName="txt" Property="Text" Value="OPTIMIZATION ACTIVE"/>
                                            <Setter TargetName="icon" Property="Text" Value="✓"/>
                                        </Trigger>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="b" Property="Background" Value="#252936"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </ToggleButton.Template>
                        </ToggleButton>

                        <StackPanel Visibility="{Binding IsChecked, ElementName=BtnOptimize, Converter={StaticResource BoolToVis}}">

                            <TextBlock Text="PERFORMANCE TWEAKS" Foreground="#66FFFFFF" FontSize="11" FontWeight="Bold" Margin="0,0,0,10"/>

                            <Border Background="{StaticResource PanelBrush}" CornerRadius="10" Padding="20" BorderBrush="#15FFFFFF" BorderThickness="1">
                                <StackPanel>
                                    <CheckBox Style="{StaticResource ProSwitch}" Content="High Priority Process" ToolTip="Maximizes CPU resources for the game process." IsChecked="True"/>
                                    <Rectangle Height="1" Fill="#11FFFFFF" Margin="0,5"/>
                                    <CheckBox Style="{StaticResource ProSwitch}" Content="Disable Fullscreen Optimizations" ToolTip="Reduces input lag by bypassing DWM." IsChecked="True"/>
                                    <Rectangle Height="1" Fill="#11FFFFFF" Margin="0,5"/>
                                    <CheckBox Style="{StaticResource ProSwitch}" Content="Ultimate GPU Performance" ToolTip="Forces GPU max clocks via Registry." IsChecked="True" Click="GpuSwitch_Click" Tag="{Binding}"/>
                                </StackPanel>
                            </Border>

                            <TextBlock Text="GAME CONFIG" Foreground="#66FFFFFF" FontSize="11" FontWeight="Bold" Margin="0,25,0,10"/>

                            <Button Click="BtnInjectConfig_Click" Tag="{Binding}" Height="44" Cursor="Hand" Visibility="{Binding ShowInjectButton, Converter={StaticResource BoolToVis}}">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Grid>
                                            <Border x:Name="bb" Background="Transparent" BorderBrush="{StaticResource NeonBrush}" BorderThickness="1" CornerRadius="8"/>
                                            <Border x:Name="glow" Background="{StaticResource NeonBrush}" Opacity="0.05" CornerRadius="8"/>
                                            <TextBlock Text="INJECT PRO CONFIG" Foreground="{StaticResource NeonBrush}" FontSize="11" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Grid>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="glow" Property="Opacity" Value="0.15"/>
                                                <Setter TargetName="bb" Property="BorderBrush" Value="White"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </StackPanel>

                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Grid>
    </Grid>
</Page>